{# src/_includes/post.njk #}
{# Template gabungan untuk Portofolio dan Blog #}

---
layout: "layout.njk" {# Halaman detail ini masih menggunakan layout utama #}
---

{# 'category' diambil dari front matter (portofolio atau blog) #}
{% set category = category %}

<article class="max-w-4xl mx-auto py-12 px-4 sm:px-6 lg:px-8">
    
    {# --- HEADER PROYEK/BLOG --- #}
    <header class="mb-8 border-b border-gray-200 pb-8">
        
        {# Judul dari Front Matter #}
        <h1 class="text-4xl md:text-5xl font-extrabold text-slate-900 mb-4 tracking-tight">
            {{ title }}
        </h1>
        
        {# Info Meta #}
        <div class="flex flex-wrap gap-x-4 gap-y-2 text-base text-slate-600">
            <span>
                <strong class="text-slate-700">Tanggal:</strong> 
                {{ date | readableDate }}
            </span>

            {# HANYA TAMPILKAN JIKA INI PORTOFOLIO #}
            {% if category == 'portofolio' %}
            <span class="text-gray-300">|</span>
            <span><strong class="text-slate-700">Peran:</strong> {{ peran }}</span>
            <span class="text-gray-300">|</span>
            <span><strong class="text-slate-700">Status:</strong> {{ status }}</span>
            {% endif %}
        </div>
    </header>

    {# --- GAMBAR UTAMA --- #}
    <img src="{{ ('/static/uploads/' + image_filename) | url }}" 
         alt="{{ title }}" 
         class="w-full h-auto rounded-xl shadow-lg mb-10">

    {# HANYA TAMPILKAN JIKA INI PORTOFOLIO #}
    {% if category == 'portofolio' %}
        {# --- TOMBOL AKSI (Hanya Portofolio) --- #}
        <div class="flex flex-wrap gap-4 mb-10">
            {% if url_demo %}
            <a href="{{ url_demo }}" 
               target="_blank" rel="noopener noreferrer"
               class="inline-flex items-center gap-2 bg-teal-500 hover:bg-teal-600 text-white font-medium py-2 px-5 rounded-lg shadow-md transition-all duration-200 transform hover:-translate-y-0.5">
                <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" viewBox="0 0 20 20" fill="currentColor">
                  <path fill-rule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zM9.555 7.168A1 1 0 008 8v4a1 1 0 001.555.832l3-2a1 1 0 000-1.664l-3-2z" clip-rule="evenodd" />
                </svg>
                Demo Live
            </a>
            {% endif %}
            {% if url_repo %}
            <a href="{{ url_repo }}" 
               target="_blank" rel="noopener noreferrer"
               class="inline-flex items-center gap-2 bg-gray-800 hover:bg-gray-700 text-white font-medium py-2 px-5 rounded-lg shadow-md transition-all duration-200 transform hover:-translate-y-0.5">
                <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" viewBox="0 0 20 20" fill="currentColor">
                  <path d="M2 6a2 2 0 012-2h6a2 2 0 012 2v8a2 2 0 01-2 2H4a2 2 0 01-2-2V6zM14.553 7.106A1 1 0 0014 8v4a1 1 0 00.553.894l2 1A1 1 0 0018 13V7a1 1 0 00-1.447-.894l-2 1z" />
                </svg>
                Lihat Kode
            </a>
            {% endif %}
        </div>
    {% endif %}

    {# --- KONTEN MARKDOWN --- #}
    {# Kelas 'prose' (dari @tailwindcss/typography) akan menata semua HTML #}
    {# yang dihasilkan dari Markdown secara otomatis #}
    <div class="prose prose-lg max-w-none prose-h2:font-bold prose-h2:text-slate-800 prose-h2:border-b prose-h2:pb-2 prose-a:text-teal-600 hover:prose-a:text-teal-700 prose-blockquote:border-teal-500 prose-blockquote:bg-teal-50 prose-blockquote:text-teal-800">
        
        {# HANYA TAMPILKAN JIKA INI PORTOFOLIO #}
        {% if category == 'portofolio' %}
            
            <h2>Ringkasan Proyek</h2>
            {# 'lead' adalah kelas khusus dari plugin typography #}
            <p class="lead">{{ ringkasan }}</p>

            <h2>Tech Stack</h2>
            <div class="flex flex-wrap gap-2">
                {% for tech in tech_stack %}
                {# 'not-prose' untuk mencegah 'prose' menata span ini #}
                <span class="not-prose inline-block bg-gray-200 text-gray-800 text-sm font-semibold px-3 py-1 rounded-full">{{ tech }}</span>
                {% endfor %}
            </div>

            <h2>Masalah & Tujuan</h2>
            {{ masalah_dan_tujuan | safe }}

            <h2>Tantangan Utama</h2>
            {{ tantangan | safe }}

            <h2>Pelajaran yang Dipetik</h2>
            {{ pelajaran_dipetik | safe }}

            <hr>
            <h2>Detail Implementasi & Fitur</h2>
        {% endif %}
        
        {# Ini adalah 'body' utama dari file .md (akan tampil untuk Blog dan Portofolio) #}
        {{ content | safe }} 

    </div>
</article>